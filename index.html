<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Recibos</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        .recibo { display: none; border: 1px solid #000; padding: 20px; margin-top: 20px; text-align: left; }
        .recibo img { width: 100px; display: block; margin: auto; }
        .recibo h2 { text-align: center; font-weight: bold; }
        .detalhes { text-align: right; margin-bottom: 10px; }
        .descricao { text-align: left; margin-top: 10px; }
        .assinatura { margin-top: 20px; text-align: center; }
        .rodape { text-align: center; margin-top: 20px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">Gerador de Recibos</h2>
        
        <div class="mb-3">
            <label class="form-label">Nome do Responsável:</label>
            <input type="text" class="form-control" id="responsavel" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label">Valor Pago (R$):</label>
            <input type="number" class="form-control" id="valor" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label">Data do Pagamento:</label>
            <input type="date" class="form-control" id="data" required>
        </div>
        
        <button class="btn btn-primary" onclick="gerarRecibo()">Gerar Recibo</button>
        <button class="btn btn-secondary" onclick="imprimirRecibo()" style="display: none;" id="btnImprimir">Imprimir</button>
        <button class="btn btn-success" onclick="gerarPDF()" style="display: none;" id="btnPDF">Salvar como PDF</button>
        
        <div class="recibo card mt-4 p-3" id="recibo">
            <img src="logo_emadec.png" alt="Logo EMADEC">
            <h2>Recibo</h2>
            <div class="detalhes">
                <p><strong>Valor Total:</strong> R$ <span id="valorPago"></span></p>
            </div>
            <div class="descricao">
                <p>Confirmamos o recebimento de <span id="valorExtenso"></span> de <span id="nomeResp"></span>, referente à Mensalidade <span id="mesAno"></span>.</p>
            </div>
            <div class="detalhes">
                <p>Caçapava, <span id="dataPag"></span></p>
            </div>
            <div class="assinatura">
                <p>________________________</p>
                <p>EMADEC</p>
            </div>
           
        </div>
    </div>
    
    <script>
        function valorPorExtenso(valor) {
    const unidades = ["", "um", "dois", "três", "quatro", "cinco", "seis", "sete", "oito", "nove"];
    const especiais = ["dez", "onze", "doze", "treze", "quatorze", "quinze", "dezesseis", "dezessete", "dezoito", "dezenove"];
    const dezenas = ["", "", "vinte", "trinta", "quarenta", "cinquenta", "sessenta", "setenta", "oitenta", "noventa"];
    const centenas = ["", "cento", "duzentos", "trezentos", "quatrocentos", "quinhentos", "seiscentos", "setecentos", "oitocentos", "novecentos"];

    if (valor === 0) return "zero reais";

    let valorStr = "";
    let inteiro = Math.floor(valor);
    let centavos = Math.round((valor - inteiro) * 100);

    if (inteiro < 10) {
        valorStr = unidades[inteiro];
    } else if (inteiro < 20) {
        valorStr = especiais[inteiro - 10];
    } else if (inteiro < 100) {
        valorStr = dezenas[Math.floor(inteiro / 10)] + (inteiro % 10 !== 0 ? " e " + unidades[inteiro % 10] : "");
    } else {
        valorStr = centenas[Math.floor(inteiro / 100)] + (inteiro % 100 !== 0 ? " e " + valorPorExtenso(inteiro % 100) : "");
    }

    valorStr += " reais";

    if (centavos > 0) {
        valorStr += " e " + (centavos < 10 ? unidades[centavos] : especiais[centavos - 10]) + " centavos";
    }

    return valorStr.charAt(0).toUpperCase() + valorStr.slice(1);
}

        function gerarRecibo() {
            const responsavel = document.getElementById('responsavel').value;
            const valor = document.getElementById('valor').value;
            const data = document.getElementById('data').value;
            
            if (!responsavel || !valor || !data) {
                alert('Preencha todos os campos!');
                return;
            }
            
            const dataObj = new Date(data);
            const mesAno = dataObj.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });
            
            document.getElementById('nomeResp').textContent = responsavel;
            document.getElementById('valorPago').textContent = parseFloat(valor).toFixed(2);
            document.getElementById('valorExtenso').textContent = valorPorExtenso(parseFloat(valor));
            document.getElementById('dataPag').textContent = dataObj.toLocaleDateString('pt-BR');
            document.getElementById('mesAno').textContent = mesAno;
            
            document.getElementById('recibo').style.display = 'block';
            document.getElementById('btnImprimir').style.display = 'inline';
            document.getElementById('btnPDF').style.display = 'inline';
        }
        
        function gerarPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const img = new Image();
    img.src = 'logo_emadec.png';

    img.onload = function() {
        doc.addImage(img, 'PNG', 80, 10, 50, 30);
        doc.text("Recibo", 90, 50);
        doc.text(`Valor Total: R$ ${document.getElementById('valorPago').textContent}`, 20, 80);
        doc.text(`Recebemos de: ${document.getElementById('nomeResp').textContent}`, 20, 90);
        doc.text(`Valor: ${document.getElementById('valorExtenso').textContent}`, 20, 100);

        // Garantindo que o mês seja dinâmico
        const dataInput = document.getElementById('data').value;
        const dataObj = new Date(dataInput);
        const mesAnoPDF = dataObj.toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' });

        // Quebra de linha automática se o texto for muito grande
        const textoRecibo = `Confirmamos o recebimento de ${document.getElementById('valorExtenso').textContent} de ${document.getElementById('nomeResp').textContent}, referente à Mensalidade ${mesAnoPDF}.`;
        const textoQuebrado = doc.splitTextToSize(textoRecibo, 170);
        doc.text(textoQuebrado, 20, 110);

        doc.text(`Caçapava, ${document.getElementById('dataPag').textContent}`, 20, 130);
        doc.text("________________________", 70, 150);
        doc.text("EMADEC", 90, 160);

        doc.save("recibo.pdf");
    };
}

    </script>
</body>
</html>
